(this.webpackJsonpguandacontactman=this.webpackJsonpguandacontactman||[]).push([[0],{185:function(e,t,n){},286:function(e,t,n){},290:function(e,t,n){"use strict";n.r(t);var a=n(5),c=n(0),r=n.n(c),s=n(28),i=n.n(s),o=n(10),l=n.n(o),u=n(21),j=(n(185),n(174)),d=n(25),f=n(131),p=n.n(f),b=n(299),x=n(178),h=!1,m=function(e,t){h||(h=!0,"success"===e?x.a.success({message:"\u6210\u529f",description:t,duration:1.5}):"error"===e&&x.a.error({message:"\u932f\u8aa4",description:t,duration:1.5}),setTimeout((function(){h=!1}),2e3))},O=n(297),v=n(39),g=n(302),y=n(303),w=n(298),k=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState(!1),s=Object(d.a)(c,2),i=s[0],o=s[1],j=r.a.useState(""),f=Object(d.a)(j,2),p=f[0],b=f[1],x=r.a.useState(""),h=Object(d.a)(x,2),m=h[0],O=h[1],k=function(){var e=Object(u.a)(l.a.mark((function e(){var a,c,r,s,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/app/".concat(t));case 2:if(a=e.sent){c=a.report,r=Object(v.a)(c);try{for(r.s();!(s=r.n()).done;)"App locked"===(i=s.value).Key?o("true"===i.Value):"App dir"===i.Key?b(i.Value):"App deploy source"===i.Key&&O(i.Value)}catch(l){r.e(l)}finally{r.f()}}case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.useEffect((function(){k()}),[]),Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(g.b,{bordered:!0,column:{sm:2,xs:1},children:[Object(a.jsx)(g.b.Item,{label:"Lock",children:Object(a.jsx)(y.a,{checked:i})}),Object(a.jsx)(g.b.Item,{label:"App dir",children:p}),Object(a.jsx)(g.b.Item,{label:"App deploy source",children:m}),Object(a.jsx)(g.b.Item,{label:"Git remote Add",children:Object(a.jsx)(w.a.Paragraph,{copyable:!0,children:"git remote add ".concat(t," dokku@").concat(n.globalDomain,":").concat(t)})})]})})},N=n(35),C=n(294),P=function(e){var t=e.title,n=e.message,c=e.onClick,r=e.disabled;return Object(a.jsx)(N.a,{type:"primary",danger:!0,disabled:r,onClick:function(){b.a.confirm({title:"Confirm",icon:Object(a.jsx)("i",{}),content:n,okText:"Confirm?",cancelText:"Cancel",onOk:c})},children:t})},S=n(296),I=n(300),A=function(e){var t=e.title,n=e.onClick,c=e.disabled,r=e.htmlType,s=void 0===r?"button":r;return Object(a.jsx)(N.a,{type:"primary",disabled:c,onClick:n,htmlType:s,children:t})},D=function(e){var t=e.onSuccess,n=e.appName,c=r.a.useContext(W);r.a.useEffect((function(){}),[]);var s=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.setModal(null),e.next=3,c.fetch("post","/api/proxy/".concat(n),{scheme:a.scheme,hostPort:a.hostPort,containerPort:a.containerPort});case 3:e.sent&&(m("success","Success Add"),t());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:s,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Proxy"}),Object(a.jsx)(S.a.Item,{name:"scheme",rules:[{required:!0,message:"Input scheme"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-shield"}),placeholder:"Please input scheme"})}),Object(a.jsx)(S.a.Item,{name:"hostPort",rules:[{required:!0,message:"Input host port"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-hand-o-down"}),placeholder:"Please input host port"})}),Object(a.jsx)(S.a.Item,{name:"containerPort",rules:[{required:!0,message:"Input container port"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-hand-o-up"}),placeholder:"Please input container port"})}),Object(a.jsx)(S.a.Item,{className:"text-center",children:Object(a.jsx)(A,{title:"Add",htmlType:"submit"})})]})},T=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState([]),s=Object(d.a)(c,2),i=s[0],o=s[1],j=r.a.useState(!1),f=Object(d.a)(j,2),p=f[0],x=f[1],h=r.a.useState(""),O=Object(d.a)(h,2),w=O[0],k=O[1],S=function(){var e=Object(u.a)(l.a.mark((function e(){var a,c,r,s,i,u,j,d,f,p,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/proxy/".concat(t));case 2:a=e.sent,c=a.report,r=[],s=Object(v.a)(c);try{for(s.s();!(i=s.n()).done;)if("Proxy enabled"===(u=i.value).Key)x("true"===u.Value);else if("Proxy type"===u.Key)k(u.Value);else if("Proxy port map"===u.Key){j=u.Value.split(" "),d=Object(v.a)(j);try{for(d.s();!(f=d.n()).done;)p=f.value,3===(b=p.split(":")).length&&r.push({scheme:b[0],hostPort:b[1],containerPort:b[2]})}catch(l){d.e(l)}finally{d.f()}}}catch(l){s.e(l)}finally{s.f()}o(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.a.useEffect((function(){S()}),[]);var I=[{title:"Scheme",align:"center",dataIndex:"scheme"},{title:"HostPort",align:"center",dataIndex:"hostPort"},{title:"ContainerPort",align:"center",dataIndex:"containerPort"},{title:"Delete",align:"center",render:function(e){return Object(a.jsx)(P,{title:"Delete Proxy",message:"Confirm delete proxy?",onClick:Object(u.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.fetch("delete","/api/proxy/".concat(t),{scheme:e.scheme,hostPort:e.hostPort,containerPort:e.containerPort});case 2:a.sent&&S();case 4:case"end":return a.stop()}}),a)})))})}}],A=function(){var e=Object(u.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=p?"disable":"enable",b.a.confirm({title:"Confirm to ".concat(c," proxy?"),icon:Object(a.jsx)("i",{}),content:c,okText:"Confirm",cancelText:"Cancel",onOk:function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("patch","/api/proxy/".concat(t,"/").concat(c));case 2:e.sent&&(m("success","Success ".concat(c," proxy")),S());case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"mb-2 d-flex flex-row-reverse",children:Object(a.jsx)(N.a,{type:"primary",onClick:function(){n.setModal(Object(a.jsx)(D,{onSuccess:S,appName:t}))},children:"Add Proxy"})}),Object(a.jsxs)(g.b,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1},children:[Object(a.jsx)(g.b.Item,{label:"Enable",children:Object(a.jsx)(y.a,{checked:p,onChange:A})}),Object(a.jsx)(g.b.Item,{label:"Proxy Type",children:w})]}),Object(a.jsx)("div",{className:"m-2"}),Object(a.jsx)(C.a,{dataSource:i,columns:I,pagination:!1})]})},F=function(e){var t=e.onSuccess,n=e.appName,c=r.a.useContext(W);r.a.useEffect((function(){}),[]);var s=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c.setModal(null),e.next=3,c.fetch("post","/api/domain/".concat(n),[a.domain]);case 3:e.sent&&(m("success","Success Add"),t());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:s,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Domain"}),Object(a.jsx)(S.a.Item,{name:"domain",rules:[{required:!0,message:"Input domain"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-user"}),placeholder:"Please input domain"})}),Object(a.jsx)(S.a.Item,{className:"text-center",children:Object(a.jsx)(A,{title:"Add",htmlType:"submit"})})]})},K=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState([]),s=Object(d.a)(c,2),i=s[0],o=s[1],j=r.a.useState(!1),f=Object(d.a)(j,2),p=f[0],b=f[1],x=function(){var e=Object(u.a)(l.a.mark((function e(){var a,c,r,s,i,u,j,d,f,p;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/domain/".concat(t));case 2:a=e.sent,c=a.report,r=[],s=Object(v.a)(c);try{for(s.s();!(i=s.n()).done;)if("Domains app enabled"===(u=i.value).Key)b("true"===u.Value);else if("Domains app vhosts"===u.Key){j=u.Value.split(" "),d=Object(v.a)(j);try{for(d.s();!(f=d.n()).done;)""!==(p=f.value)&&r.push({host:p})}catch(l){d.e(l)}finally{d.f()}}}catch(l){s.e(l)}finally{s.f()}o(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.a.useEffect((function(){x()}),[]);var h=[{title:"Host",align:"center",dataIndex:"host"},{title:"Delete",align:"center",render:function(e){return Object(a.jsx)(P,{title:"Delete Domain",message:"Confirm delete domain?",onClick:Object(u.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.fetch("delete","/api/domain/".concat(t),[e.host]);case 2:a.sent&&x();case 4:case"end":return a.stop()}}),a)})))})}}];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"mb-2 d-flex flex-row-reverse",children:Object(a.jsx)(N.a,{type:"primary",onClick:function(){n.setModal(Object(a.jsx)(F,{onSuccess:x,appName:t}))},children:"Add Domain"})}),Object(a.jsx)(g.b,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:3,sm:2,xs:1},children:Object(a.jsx)(g.b.Item,{label:"Enable",children:Object(a.jsx)(y.a,{checked:p})})}),Object(a.jsx)("div",{className:"m-2"}),Object(a.jsx)(C.a,{dataSource:i,columns:h,pagination:!1})]})},E=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState([]),s=Object(d.a)(c,2),i=s[0],o=s[1],j=function(){var e=Object(u.a)(l.a.mark((function e(){var a,c,r,s,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/git/".concat(t));case 2:a=e.sent,c=a.report,r=[],s=Object(v.a)(c);try{for(s.s();!(i=s.n()).done;)u=i.value,r.push({key:u.Key,value:u.Value})}catch(l){s.e(l)}finally{s.f()}o(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.a.useEffect((function(){j()}),[]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsx)(C.a,{dataSource:i,columns:[{title:"Key",align:"center",dataIndex:"key"},{title:"Value",align:"center",dataIndex:"value"}],pagination:!1})})},V=function(e){var t=e.onSuccess,n=e.appName,c=e.restart,s=r.a.useContext(W);r.a.useEffect((function(){}),[]);var i=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.setModal(null),e.next=3,s.fetch("post","/api/config/".concat(n),{restart:c,config:[{key:a.key,value:a.value}]});case 3:e.sent&&(m("success","Success Add"),t());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:i,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Config"}),Object(a.jsx)(S.a.Item,{label:"Key",name:"key",rules:[{required:!0,message:"Input key"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-key"}),placeholder:"Please input key"})}),Object(a.jsx)(S.a.Item,{label:"Value",name:"value",rules:[{required:!0,message:"Input value"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-folder-open"}),placeholder:"Please input value"})}),Object(a.jsxs)(S.a.Item,{className:"text-center",children:[Object(a.jsx)(a.Fragment,{}),Object(a.jsx)(A,{title:"Add",htmlType:"submit"})]})]})},M=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState([]),s=Object(d.a)(c,2),i=s[0],o=s[1],j=r.a.useState(!0),f=Object(d.a)(j,2),p=f[0],b=f[1],x=function(){var e=Object(u.a)(l.a.mark((function e(){var a,c,r,s,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/config/".concat(t));case 2:a=e.sent,c=a.report,r=[],s=Object(v.a)(c);try{for(s.s();!(i=s.n()).done;)u=i.value,r.push({key:u.Key,value:u.Value})}catch(l){s.e(l)}finally{s.f()}o(r);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.a.useEffect((function(){x()}),[]);var h=[{title:"Key",align:"center",dataIndex:"key"},{title:"Value",align:"center",dataIndex:"value",width:800,render:function(e){return Object(a.jsx)("div",{style:{wordWrap:"break-word",width:800},children:e})}},{title:"Delete",align:"center",render:function(e){return Object(a.jsx)(P,{title:"Delete",message:"Confirm delete config key?",onClick:Object(u.a)(l.a.mark((function a(){return l.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,n.fetch("delete","/api/config/".concat(t,"/").concat(e.key,"?restart=").concat(p));case 2:a.sent&&x();case 4:case"end":return a.stop()}}),a)})))})}}];return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"mb-2 d-flex ",children:[Object(a.jsx)("div",{className:"mx-1",children:"Restart After Change"}),Object(a.jsx)(y.a,{checked:p,onChange:b}),Object(a.jsx)("div",{className:"flex-fill"}),Object(a.jsx)(N.a,{type:"primary",onClick:function(){n.setModal(Object(a.jsx)(V,{onSuccess:x,appName:t,restart:p}))},children:"Add Config"})]}),Object(a.jsx)(C.a,{dataSource:i,columns:h,pagination:!1})]})},q=n(301),L=n(170),G=n.n(L),U=function(e){var t=e.appName,n=r.a.useContext(W),c=r.a.useState([]),s=Object(d.a)(c,2),i=s[0],o=s[1],j=r.a.useState(10),f=Object(d.a)(j,2),p=f[0],b=f[1],x=function(){var e=Object(u.a)(l.a.mark((function e(){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.fetch("get","/api/logs/".concat(t,"/").concat(p));case 2:(a=e.sent)&&o(a.report.split("\n"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.useEffect((function(){x()}),[]),Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{children:[Object(a.jsx)(q.a,{min:1,defaultValue:p,onChange:function(e){b(e)}}),Object(a.jsx)(A,{title:"Show ".concat(p," of logs"),onClick:x})]}),Object(a.jsxs)(w.a,{children:[Object(a.jsx)(w.a.Title,{children:"".concat(t," LOG")}),i.map((function(e){return Object(a.jsx)(w.a.Paragraph,{children:Object(a.jsx)(G.a,{children:e})})}))]})]})},z=function(e){var t=e.appName,n=(r.a.useContext(W),function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}());r.a.useEffect((function(){n()}),[]);return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(O.a,{defaultActiveKey:"1",onChange:function(e){},children:[Object(a.jsx)(O.a.TabPane,{tab:"Report",children:Object(a.jsx)(k,{appName:t})},"report"),Object(a.jsx)(O.a.TabPane,{tab:"Proxy",children:Object(a.jsx)(T,{appName:t})},"proxy"),Object(a.jsx)(O.a.TabPane,{tab:"Domain",children:Object(a.jsx)(K,{appName:t})},"domain"),Object(a.jsx)(O.a.TabPane,{tab:"Git",children:Object(a.jsx)(E,{appName:t})},"git"),Object(a.jsx)(O.a.TabPane,{tab:"Config",children:Object(a.jsx)(M,{appName:t})},"config"),Object(a.jsx)(O.a.TabPane,{tab:"Log",children:Object(a.jsx)(U,{appName:t})},"log")]})})},H=function(){var e=r.a.useContext(W);r.a.useEffect((function(){}),[]);var t=function(){var t=Object(u.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setModal(null),t.next=3,e.fetch("post","/api/app/".concat(n.appName),[n.domain]);case 3:if(!t.sent){t.next=8;break}return m("success","Success Add"),t.next=8,e.getApps();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:t,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Domain"}),Object(a.jsx)(S.a.Item,{name:"appName",rules:[{required:!0,message:"Input AppName"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-desktop"}),placeholder:"Please input AppName"})}),Object(a.jsx)(S.a.Item,{className:"text-center",children:Object(a.jsx)(A,{title:"Add",htmlType:"submit"})})]})},R=function(){var e=r.a.useContext(W),t=function(){var t=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getApps();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();r.a.useEffect((function(){t()}),[]);var n=Object(a.jsx)(N.a,{type:"primary",onClick:function(){e.setModal(Object(a.jsx)(H,{}))},children:"Add new App"});return Object(a.jsx)(a.Fragment,{children:Object(a.jsxs)(O.a,{defaultActiveKey:"upload",tabBarExtraContent:n,children:[Object(a.jsx)(O.a.TabPane,{tab:"Global Domain",children:Object(a.jsx)(J,{})},"domain"),Object(a.jsx)(O.a.TabPane,{tab:"Global Config",children:Object(a.jsx)(B,{})},"config")]})})},B=function(){var e=r.a.useContext(W),t=r.a.useState([]),n=Object(d.a)(t,2),c=n[0],s=n[1],i=r.a.useState(!0),o=Object(d.a)(i,2),j=o[0],f=o[1],p=function(){var t=Object(u.a)(l.a.mark((function t(){var n,a,c,r,i,o;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetch("get","/api/globalconfig");case 2:if(n=t.sent){a=n.report,c=[],r=Object(v.a)(a);try{for(r.s();!(i=r.n()).done;)o=i.value,c.push({key:o.Key,value:o.Value})}catch(l){r.e(l)}finally{r.f()}s(c)}case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();r.a.useEffect((function(){p()}),[]);var b=[{title:"Key",align:"center",dataIndex:"key"},{title:"Value",align:"center",dataIndex:"value"},{title:"Delete",align:"center",render:function(t){return Object(a.jsx)(P,{title:"Delete",message:"Confirm delete config key?",onClick:Object(u.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.fetch("delete","/api/globalconfig/".concat(t.key,"?restart=").concat(j));case 2:n.sent&&p();case 4:case"end":return n.stop()}}),n)})))})}}],x=function(e){var t=e.onSuccess,n=r.a.useContext(W);r.a.useEffect((function(){}),[]);var c=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setModal(null),e.next=3,n.fetch("post","/api/globalconfig",{restart:j,config:[{key:a.key,value:a.value}]});case 3:e.sent&&(m("success","Success Add"),t());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:c,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Config"}),Object(a.jsx)(S.a.Item,{label:"Key",name:"key",rules:[{required:!0,message:"Input key"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-key"}),placeholder:"Please input key"})}),Object(a.jsx)(S.a.Item,{label:"Value",name:"value",rules:[{required:!0,message:"Input value"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-folder-open"}),placeholder:"Please input value"})}),Object(a.jsxs)(S.a.Item,{className:"text-center",children:[Object(a.jsx)(a.Fragment,{}),Object(a.jsx)(A,{title:"Add",htmlType:"submit"})]})]})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)("div",{className:"mb-2 d-flex ",children:[Object(a.jsx)("div",{className:"mx-1",children:"Restart After Change"}),Object(a.jsx)(y.a,{checked:j,onChange:f}),Object(a.jsx)("div",{className:"flex-fill"}),Object(a.jsx)(N.a,{type:"primary",onClick:function(){e.setModal(Object(a.jsx)(x,{onSuccess:p}))},children:"Add Config"})]}),Object(a.jsx)(C.a,{dataSource:c,columns:b,pagination:!1})]})},J=function(){var e=r.a.useContext(W),t=r.a.useState([]),n=Object(d.a)(t,2),c=n[0],s=n[1],i=function(){var t=Object(u.a)(l.a.mark((function t(){var n,a,c,r,i,o,u,j,d,f;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.fetch("get","/api/globaldomain");case 2:if(n=t.sent){a=n.report,c=[],r=Object(v.a)(a);try{for(r.s();!(i=r.n()).done;)if("Domains global vhosts"===(o=i.value).Key){u=o.Value.split(" "),j=Object(v.a)(u);try{for(j.s();!(d=j.n()).done;)""!==(f=d.value)&&c.push({host:f})}catch(l){j.e(l)}finally{j.f()}}}catch(l){r.e(l)}finally{r.f()}c.length>0&&e.setGlobalDomain(c[0].host),s(c)}case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();r.a.useEffect((function(){i()}),[]);var o=[{title:"Host",align:"center",dataIndex:"host"},{title:"Delete",align:"center",render:function(t){return Object(a.jsx)(P,{title:"Delete Domain",message:"Confirm delete domain?",onClick:Object(u.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.fetch("delete","/api/globaldomain/".concat(t.host),[t.host]);case 2:n.sent&&i();case 4:case"end":return n.stop()}}),n)})))})}}],j=function(e){var t=e.onSuccess,n=r.a.useContext(W);r.a.useEffect((function(){}),[]);var c=function(){var e=Object(u.a)(l.a.mark((function e(a){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setModal(null),e.next=3,n.fetch("post","/api/globaldomain",[a.domain]);case 3:e.sent&&(m("success","Success Add"),t());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)(S.a,{onFinish:c,children:[Object(a.jsx)("h5",{className:"font-weight-bold mb-4",children:"Add Domain"}),Object(a.jsx)(S.a.Item,{name:"domain",rules:[{required:!0,message:"Input domain"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-user"}),placeholder:"Please input domain"})}),Object(a.jsx)(S.a.Item,{className:"text-center",children:Object(a.jsx)(A,{title:"Add",htmlType:"submit"})})]})};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"mb-2 d-flex flex-row-reverse",children:Object(a.jsx)(N.a,{type:"primary",onClick:function(){e.setModal(Object(a.jsx)(j,{onSuccess:i}))},children:"Add Domain"})}),Object(a.jsx)("div",{className:"m-2"}),Object(a.jsx)(C.a,{dataSource:c,columns:o,pagination:!1})]})},W=r.a.createContext(void 0),Q={key:"/global",title:"Global",component:Object(a.jsx)(R,{})},X=function(e){var t=e.children,n=r.a.useState("/#/login"),c=Object(d.a)(n,1)[0],s=r.a.useState("/#/global"),i=Object(d.a)(s,1)[0],o=r.a.useState(null),f=Object(d.a)(o,2),x=f[0],h=f[1],O=r.a.useState(""),v=Object(d.a)(O,2),g=v[0],y=v[1],w=r.a.useState([Q]),k=Object(d.a)(w,2),N=k[0],C=k[1],P=r.a.useState(""),S=Object(d.a)(P,2),I=S[0],A=S[1],D=r.a.useState(!1),T=Object(d.a)(D,2),F=T[0],K=T[1],E=r.a.useState(!1),V=Object(d.a)(E,2),M=V[0],q=V[1];r.a.useEffect((function(){H(),p.a.defaults.baseURL="",p.a.defaults.headers.common["Content-Type"]="application/json"}),[]);var L=function(){var e=Object(u.a)(l.a.mark((function e(t,n,a){var r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,p()({method:t,url:n,data:a});case 4:if(s=e.sent,console.log("response",s.data),3!==s.data.errorCode&&K(!0),2!==s.data.errorCode){e.next=10;break}return window.location.href=c,e.abrupt("return",null);case 10:if(0===s.data.errorCode){e.next=12;break}throw new Error(s.data.errorMessage);case 12:r=s.data,e.next=18;break;case 15:e.prev=15,e.t0=e.catch(1),m("error",e.t0.message);case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,null,[[1,15]])})));return function(t,n,a){return e.apply(this,arguments)}}(),G=function(){var e=Object(u.a)(l.a.mark((function e(t,n){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("post","/api/account/login",{account:t,password:n});case 2:a=e.sent,y(t),a&&0===a.errorCode?(m("success","Login"),window.location.href=i):window.location.href=c;case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),U=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("post","/api/account/logout",{});case 2:window.location.href=c;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(u.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("get","/api/redirect");case 2:e.sent&&(window.location.href=i),q(!0);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),R=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L("get","/api/apps");case 2:(t=e.sent)&&(n=t.list.map((function(e){return{key:"/".concat(e),title:e,component:Object(a.jsx)(z,{appName:e})}})),C([Q].concat(Object(j.a)(n))));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(a.jsxs)(W.Provider,{value:{loginPage:c,homePage:i,setModal:function(e){return h(e)},account:g,setAccount:y,fetch:L,login:G,logout:U,redirect:H,globalDomain:I,setGlobalDomain:A,getApps:R,menus:N,setMenus:C,sshKeyUploaded:F,setSshKeyUploaded:K,initialized:M},children:[x&&Object(a.jsx)(b.a,{visible:null!==x,onOk:function(){return h(null)},onCancel:function(){return h(null)},footer:null,closable:!1,children:x}),t]})},Y=n(139),Z=n(32),$=n(293),_=n(304),ee=n(78),te=function(e){var t=e.menus,n=e.title,c=e.icon,s=e.content,i=r.a.useContext(W),o=Object(Z.f)();return Object(a.jsxs)($.a,{className:"vh-100",children:[Object(a.jsx)($.a.Sider,{collapsible:!0,trigger:null,style:{overflow:"auto"},children:Object(a.jsx)(ee.a,{theme:"dark",mode:"inline",selectedKeys:[window.location.hash.slice(1)],defaultOpenKeys:[window.location.hash.slice(1)],onClick:function(e){e.item;var t=e.key;o.push(t)},children:t.map((function(e){return Object(a.jsx)(ee.a.Item,{children:Object(a.jsxs)("span",{className:"d-flex align-items-center",children:[Object(a.jsx)("div",{className:"anticon",children:Object(a.jsx)("i",{className:e.icon})}),Object(a.jsx)("span",{children:e.title})]})},e.key)}))})}),Object(a.jsxs)($.a,{className:"bg-white",children:[Object(a.jsxs)($.a.Header,{className:"d-flex align-items-center px-3 bg-white shadow-sm",style:{zIndex:1},children:[Object(a.jsxs)("div",{children:[Object(a.jsx)("i",{className:c}),Object(a.jsx)("span",{className:"ml-2",children:n})]}),Object(a.jsx)("div",{className:"flex-fill"}),Object(a.jsx)(_.a,{placement:"bottom",content:Object(a.jsx)("div",{className:"d-flex flex-column",children:Object(a.jsx)(N.a,{type:"link",danger:!0,onClick:function(){return i.logout()},children:"logout"})}),children:Object(a.jsx)(N.a,{type:"link",icon:Object(a.jsx)("i",{className:"fa fa-sign-out mr-2"}),children:"Logout"})})]}),Object(a.jsx)($.a.Content,{style:{overflow:"auto"},children:Object(a.jsx)("div",{className:"m-3",children:s})})]})]})},ne=n(143),ae=n(295),ce=n(305),re=function(){var e=r.a.useContext(W);return r.a.useEffect((function(){(function(){var t=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.redirect();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}),[]),Object(a.jsx)(a.Fragment,{})},se=function(){var e=r.a.useContext(W),t=function(){return Object(a.jsxs)(S.a,{onFinish:function(t){return e.login(t.account,t.password)},children:[Object(a.jsx)(S.a.Item,{name:"account",rules:[{required:!0,message:"Please Input Account!"}],children:Object(a.jsx)(I.a,{prefix:Object(a.jsx)("i",{className:"fa fa-user"}),placeholder:"Please input account"})}),Object(a.jsx)(S.a.Item,{name:"password",rules:[{required:!0,message:"Please Input Password!"}],children:Object(a.jsx)(I.a.Password,{prefix:Object(a.jsx)("i",{className:"fa fa-lock"}),placeholder:"Please input password"})}),Object(a.jsx)(S.a.Item,{className:"text-center",children:Object(a.jsx)(N.a,{type:"primary",shape:"round",htmlType:"submit",children:"Login"})})]})};return Object(a.jsx)("div",{className:"d-flex align-items-center vh-100",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)("div",{className:"col-4 m-4 text-center font-weight-bold",style:{fontSize:"20px"},children:"Dokku Web UI"})}),Object(a.jsx)("div",{className:"m-5"}),Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)("div",{className:"col-4",children:Object(a.jsx)(t,{})})})]})})},ie=function(){return Object(a.jsx)(a.Fragment,{children:"404"})},oe=function(){var e=r.a.useContext(W),t={name:"uploadfile",action:"/api/ssh/upload",onChange:function(t){return Object(u.a)(l.a.mark((function n(){return l.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:"uploading"!==t.file.status&&console.log(t.file,t.fileList),"done"===t.file.status?(m("success","success upload!"),e.setSshKeyUploaded(!0),window.location.href=e.loginPage):"error"===t.file.status&&m("success","upload fail!");case 2:case"end":return n.stop()}}),n)})))()}};return Object(a.jsx)("div",{className:"d-flex align-items-center vh-100",children:Object(a.jsxs)("div",{className:"container",children:[Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)("div",{className:"col-4 m-4 text-center font-weight-bold",style:{fontSize:"20px"},children:"Please Upload SSH Key First"})}),Object(a.jsx)("div",{className:"m-5"}),Object(a.jsx)("div",{className:"row justify-content-center",children:Object(a.jsx)(ae.a,Object(ne.a)(Object(ne.a)({},t),{},{children:Object(a.jsx)(N.a,{icon:Object(a.jsx)(ce.a,{}),children:"Click to Upload"})}))})]})})},le=function(){var e=r.a.useContext(W),t=function(){var t=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.redirect();case 2:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.useEffect((function(){t()}),[]),e.initialized?e.sshKeyUploaded?Object(a.jsx)(Y.a,{children:Object(a.jsxs)(Z.c,{children:[Object(a.jsx)(Z.a,{path:"/",exact:!0,component:re}),Object(a.jsx)(Z.a,{path:"/login",component:se}),e.menus.map((function(t){return Object(a.jsx)(Z.a,{path:t.key,children:Object(a.jsx)(te,{menus:e.menus,title:t.title,icon:t.icon,content:t.component})},t.key)})),Object(a.jsx)(Z.a,{path:"*",component:ie})]})}):Object(a.jsx)(oe,{}):Object(a.jsx)("div",{})},ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,306)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),r(e),s(e)}))};n(286),n(287),n(288),n(289);i.a.render(Object(a.jsx)(X,{children:Object(a.jsx)(le,{})}),document.getElementById("root")),ue()}},[[290,1,2]]]);
//# sourceMappingURL=main.8ec68c59.chunk.js.map